<turbo-frame id="forecast_frame">
  <% if local_assigns[:error].present? %>
    <div class="error-message">
      <p style="color:red;"><%= local_assigns[:error] %></p>
    </div>
  <% elsif forecast.blank? %>
    <div class="no-data-message">
      <p style="color:gray;">No forecast available for this location.</p>
    </div>
  <% else %>
    <div class="weather-result">
      <div class="location-info">
        <p><strong>Location:</strong> <%= place %> (<%= zip %>)</p>

        <div style="margin-top: 6px;">
          <span style="background:<%= from_cache ? '#e6f7ff' : '#eaffea' %>; padding:4px 8px;border-radius:4px; font-size: 0.9rem;">
            <strong><%= from_cache ? "Cached response" : "Live response" %></strong>
          </span>

          <div style="font-size: 0.85rem; color: #555; margin-top: 2px;">
            <%= cache_status_message(cache_key, from_cache) %>
          </div>
        </div>
      </div>

      <div class="current-weather">
        <h3>Current: <%= forecast[:current][:temp] %>°C</h3>
        <p>Feels like: <%= forecast[:current][:feels_like] %>°C</p>
      </div>

      <div class="today-forecast">
        <h4>Today</h4>
        <p>High: <%= forecast[:today][:high] %>°C | Low: <%= forecast[:today][:low] %>°C</p>
      </div>

      <div class="extended-forecast">
        <h4>Next 3 Days</h4>
        <ul>
          <% forecast[:next_days].each do |day| %>
            <li>
              <%= day[:date].strftime("%a") %>
              — <%= day[:high] %>° / <%= day[:low] %>°
              (<%= day[:summary] %>)
            </li>
          <% end %>
        </ul>
      </div>
    </div>
  <% end %>
</turbo-frame>
